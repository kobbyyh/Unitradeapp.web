<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Email - Unitrade</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/simple-email-service.js"></script>
</head>
<body class="bg-gray-100 min-h-screen py-8">
    <div class="max-w-4xl mx-auto px-4">
        <h1 class="text-3xl font-bold text-gray-900 mb-8">Test Email Functionality</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Test Order Notification -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Test Order Notification</h2>
                <form id="testOrderForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Seller Email</label>
                        <input type="email" id="sellerEmail" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="seller@example.com" value="test@example.com" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Product Title</label>
                        <input type="text" id="productTitle" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="iPhone 13 Pro" value="Test Product" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Product Price</label>
                        <input type="number" id="productPrice" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="1200.00" value="100.00" step="0.01" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Quantity</label>
                        <input type="number" id="quantity" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="1" value="2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Buyer Name</label>
                        <input type="text" id="buyerName" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="John Doe" value="Test Buyer" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Buyer Phone</label>
                        <input type="tel" id="buyerPhone" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="+233 123 456 789" value="+233 123 456 789" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Buyer Location</label>
                        <input type="text" id="buyerLocation" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="Accra, Ghana" value="Accra, Ghana" required>
                    </div>
                    <button type="submit" class="w-full bg-teal-600 text-white py-2 px-4 rounded-md hover:bg-teal-700">
                        Send Test Order Notification
                    </button>
                </form>
            </div>

            <!-- Test Order Confirmation -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-4">Test Order Confirmation</h2>
                <form id="testConfirmationForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Buyer Email</label>
                        <input type="email" id="buyerEmail" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="buyer@example.com" value="buyer@example.com" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Product Title</label>
                        <input type="text" id="confProductTitle" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="iPhone 13 Pro" value="Test Product" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Product Price</label>
                        <input type="number" id="confProductPrice" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="1200.00" value="100.00" step="0.01" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Quantity</label>
                        <input type="number" id="confQuantity" class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2" placeholder="1" value="2" required>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700">
                        Send Test Confirmation
                    </button>
                </form>
            </div>
        </div>

        <!-- Status Display -->
        <div class="mt-8 bg-white p-6 rounded-lg shadow">
            <h2 class="text-xl font-semibold mb-4">Email Status</h2>
            <div id="emailStatus" class="space-y-2">
                <p class="text-gray-500">Ready to send test emails...</p>
            </div>
        </div>

        <!-- Instructions -->
        <div class="mt-8 bg-blue-50 p-6 rounded-lg">
            <h2 class="text-xl font-semibold mb-4 text-blue-900">How It Works</h2>
            <div class="text-blue-800 space-y-2">
                <p>‚úÖ <strong>Email notifications are now working!</strong></p>
                <p>üìß When you place an order, the seller will receive an email with:</p>
                <ul class="list-disc list-inside ml-4 space-y-1">
                    <li>Order details (product, price, quantity)</li>
                    <li>Buyer's contact information (name, phone, location)</li>
                    <li>Order ID and date</li>
                </ul>
                <p>üéâ <strong>No more notification screens needed!</strong> Sellers get instant email notifications.</p>
            </div>
        </div>
    </div>

    <script>
        // Test Order Notification Form
        document.getElementById('testOrderForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const orderData = {
                id: 'test_order_' + Date.now(),
                sellerName: 'Test Seller',
                buyerName: document.getElementById('buyerName').value,
                buyerPhone: document.getElementById('buyerPhone').value,
                buyerLocation: document.getElementById('buyerLocation').value,
                productTitle: document.getElementById('productTitle').value,
                productPrice: parseFloat(document.getElementById('productPrice').value),
                totalPrice: parseFloat(document.getElementById('productPrice').value),
                quantity: parseInt(document.getElementById('quantity').value),
                shippingAddress: document.getElementById('buyerLocation').value
            };

            const sellerEmail = document.getElementById('sellerEmail').value;

            try {
                updateStatus('Sending order notification...', 'info');
                const result = await emailService.sendOrderNotification(orderData, sellerEmail);
                updateStatus('‚úÖ Order notification sent successfully!', 'success');
            } catch (error) {
                updateStatus('‚ùå Error sending order notification: ' + error.message, 'error');
            }
        });

        // Test Order Confirmation Form
        document.getElementById('testConfirmationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const orderData = {
                id: 'test_order_' + Date.now(),
                buyerName: 'Test Buyer',
                productTitle: document.getElementById('confProductTitle').value,
                productPrice: parseFloat(document.getElementById('confProductPrice').value),
                totalPrice: parseFloat(document.getElementById('confProductPrice').value),
                quantity: parseInt(document.getElementById('confQuantity').value)
            };

            const buyerEmail = document.getElementById('buyerEmail').value;

            try {
                updateStatus('Sending order confirmation...', 'info');
                const result = await emailService.sendOrderConfirmation(orderData, buyerEmail);
                updateStatus('‚úÖ Order confirmation sent successfully!', 'success');
            } catch (error) {
                updateStatus('‚ùå Error sending order confirmation: ' + error.message, 'error');
            }
        });

        // Update status display
        function updateStatus(message, type) {
            const statusDiv = document.getElementById('emailStatus');
            const statusClass = type === 'success' ? 'text-green-600' : type === 'error' ? 'text-red-600' : 'text-blue-600';
            statusDiv.innerHTML = `<p class="${statusClass}">${message}</p>`;
        }
    </script>
</body>
</html>
